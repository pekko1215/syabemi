// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

enum GuildRole {
  USER
  ADMIN
}

model ActiveGuild {
  id                Int               @id @default(autoincrement())
  guildId           String            @unique
  role              GuildRole
  updatedAt         DateTime
  createdAt         DateTime          @default(now())
  enteringStatus    EnteringRoom?
  dictionaryIndexes DictionaryIndex[]
  readUpQueue       ReadUpQueue[]
}

model EnteringRoom {
  id        Int         @id @default(autoincrement())
  updatedAt DateTime
  createdAt DateTime    @default(now())
  guild     ActiveGuild @relation(fields: [guildId], references: [guildId])
  guildId   String      @unique
  channelId String      @unique
  hostId    String
}

model DictionaryIndex {
  id        Int         @id @default(autoincrement())
  updatedAt DateTime
  createdAt DateTime    @default(now())
  guild     ActiveGuild @relation(fields: [guildId], references: [guildId])
  guildId   String
  before    String      @db.VarChar(64)
  after     String      @db.VarChar(64)
}

model ReadUpQueue {
  id       Int         @id @default(autoincrement())
  text     String
  priority Int
  guild    ActiveGuild @relation(fields: [guildId], references: [guildId])
  guildId  String
}
